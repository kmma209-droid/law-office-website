<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحكم المقالات</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background-color: #fff; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        #articleForm { display: none; margin-top: 20px; }
        #articleForm.active { display: block; }
        .article-list-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #eee; }
    </style>
</head>
<body>
    <div class="container py-5">
        <h3 class="text-center mb-4">لوحة تحكم المقالات</h3>
        <div class="d-flex justify-content-between align-items-center mb-4">
            <p class="lead mb-0">مرحباً بك، يمكنك إدارة المقالات من هنا.</p>
            <button class="btn btn-success" id="addArticleBtn">أضف مقال جديد</button>
        </div>

        <form id="articleForm">
            <input type="hidden" id="articleId">
            <div class="mb-3">
                <label for="articleTitle" class="form-label">عنوان المقال</label>
                <input type="text" class="form-control" id="articleTitle" required>
            </div>
            <div class="mb-3">
                <label for="articleCategory" class="form-label">تصنيف المقال</label>
                <input type="text" class="form-control" id="articleCategory" required>
            </div>
            <div class="mb-3">
                <label for="articleDate" class="form-label">تاريخ النشر</label>
                <input type="date" class="form-control" id="articleDate" required>
            </div>
            <div class="mb-3">
                <label for="articleImage" class="form-label">رابط صورة المقال</label>
                <input type="url" class="form-control" id="articleImage" required>
            </div>
            <div class="mb-3">
                <label for="articleContent" class="form-label">محتوى المقال</label>
                <textarea class="form-control" id="articleContent" rows="8" required></textarea>
            </div>
            <div class="d-flex justify-content-end gap-2">
                <button type="button" class="btn btn-secondary" id="cancelBtn">إلغاء</button>
                <button type="submit" class="btn btn-primary">حفظ</button>
            </div>
        </form>

        <div class="mt-4" id="articlesList">
            <h4>المقالات الموجودة</h4>
            <div id="articleListContainer" class="list-group"></div>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'blogArticles';

        function getArticles() {
            const storedArticles = localStorage.getItem(STORAGE_KEY);
            return storedArticles ? JSON.parse(storedArticles) : [];
        }

        function saveArticles(articles) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(articles));
        }

        let articles = getArticles();

        const addArticleBtn = document.getElementById('addArticleBtn');
        const articleForm = document.getElementById('articleForm');
        const articleListContainer = document.getElementById('articleListContainer');

        const articleIdInput = document.getElementById('articleId');
        const articleTitleInput = document.getElementById('articleTitle');
        const articleCategoryInput = document.getElementById('articleCategory');
        const articleDateInput = document.getElementById('articleDate');
        const articleImageInput = document.getElementById('articleImage');
        const articleContentInput = document.getElementById('articleContent');
        const cancelBtn = document.getElementById('cancelBtn');

        function renderArticles() {
            articleListContainer.innerHTML = '';
            articles.forEach(article => {
                const item = document.createElement('div');
                item.className = 'article-list-item list-group-item';
                item.innerHTML = `
                    <span>${article.title}</span>
                    <div class="actions">
                        <button class="btn btn-warning btn-sm edit-btn" data-id="${article.id}">تعديل</button>
                        <button class="btn btn-danger btn-sm delete-btn" data-id="${article.id}">حذف</button>
                    </div>
                `;
                articleListContainer.appendChild(item);
            });
            attachEventListeners();
        }

        function showForm(article = null) {
            articleForm.classList.add('active');
            if (article) {
                articleIdInput.value = article.id;
                articleTitleInput.value = article.title;
                articleCategoryInput.value = article.category;
                articleDateInput.value = article.date;
                articleImageInput.value = article.image;
                articleContentInput.value = article.content;
            } else {
                articleIdInput.value = '';
                articleForm.reset();
            }
        }

        function hideForm() {
            articleForm.classList.remove('active');
        }

        articleForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const newArticle = {
                title: articleTitleInput.value,
                category: articleCategoryInput.value,
                date: articleDateInput.value,
                image: articleImageInput.value,
                content: articleContentInput.value
            };
            const articleId = articleIdInput.value;
            if (articleId) {
                const index = articles.findIndex(a => a.id == articleId);
                if (index !== -1) {
                    articles[index] = { ...articles[index], ...newArticle, id: parseInt(articleId) };
                }
            } else {
                newArticle.id = Date.now();
                articles.push(newArticle);
            }
            saveArticles(articles);
            renderArticles();
            hideForm();
        });

        addArticleBtn.addEventListener('click', () => showForm());
        cancelBtn.addEventListener('click', () => hideForm());

        function attachEventListeners() {
            document.querySelectorAll('.edit-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const id = e.target.getAttribute('data-id');
                    const articleToEdit = articles.find(a => a.id == id);
                    if (articleToEdit) {
                        showForm(articleToEdit);
                    }
                });
            });

            document.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const id = e.target.getAttribute('data-id');
                    if (confirm('هل أنت متأكد من حذف هذا المقال؟')) {
                        articles = articles.filter(a => a.id != id);
                        saveArticles(articles);
                        renderArticles();
                    }
                });
            });
        }

        document.addEventListener('DOMContentLoaded', renderArticles);
    </script>
</body>
</html>